<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>js | 技能总结</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/favicon.ico">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon-152x152.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#3eaf7c">
    <meta name="description" content="Just playing around">
    <meta name="auth" content="星辰">
    <meta name="keywords" content="星辰简介说明">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
    <meta name="msapplication-TileColor" content="#000000">
    
<<<<<<< HEAD:docs/.vuepress/dist/javascript/js/index.html
    <link rel="preload" href="/assets/css/0.styles.31e66d80.css" as="style"><link rel="preload" href="/assets/js/app.c4b7f1ba.js" as="script"><link rel="preload" href="/assets/js/2.08c95936.js" as="script"><link rel="preload" href="/assets/js/1.80ba04c7.js" as="script"><link rel="preload" href="/assets/js/35.dd6a1dfd.js" as="script"><link rel="preload" href="/assets/js/20.05fe0eb6.js" as="script"><link rel="prefetch" href="/assets/js/10.8a933fae.js"><link rel="prefetch" href="/assets/js/11.b348d638.js"><link rel="prefetch" href="/assets/js/12.c901df62.js"><link rel="prefetch" href="/assets/js/13.816a93d7.js"><link rel="prefetch" href="/assets/js/14.0ed80cb4.js"><link rel="prefetch" href="/assets/js/15.c2889a45.js"><link rel="prefetch" href="/assets/js/16.2824987e.js"><link rel="prefetch" href="/assets/js/17.f5878b60.js"><link rel="prefetch" href="/assets/js/18.ba3117c2.js"><link rel="prefetch" href="/assets/js/19.ecb49bc6.js"><link rel="prefetch" href="/assets/js/21.b4c97262.js"><link rel="prefetch" href="/assets/js/22.f1440856.js"><link rel="prefetch" href="/assets/js/23.9acdaad1.js"><link rel="prefetch" href="/assets/js/24.915c148b.js"><link rel="prefetch" href="/assets/js/25.05fae5b3.js"><link rel="prefetch" href="/assets/js/26.76d2cf6c.js"><link rel="prefetch" href="/assets/js/27.98c4ad12.js"><link rel="prefetch" href="/assets/js/28.32a746a5.js"><link rel="prefetch" href="/assets/js/29.87ecd3fa.js"><link rel="prefetch" href="/assets/js/3.d4b70d98.js"><link rel="prefetch" href="/assets/js/30.e242d165.js"><link rel="prefetch" href="/assets/js/31.727cbc20.js"><link rel="prefetch" href="/assets/js/32.06889885.js"><link rel="prefetch" href="/assets/js/33.5eb804a4.js"><link rel="prefetch" href="/assets/js/34.ca6991c2.js"><link rel="prefetch" href="/assets/js/36.8dd926e1.js"><link rel="prefetch" href="/assets/js/37.214a8412.js"><link rel="prefetch" href="/assets/js/38.84559e07.js"><link rel="prefetch" href="/assets/js/39.798512fd.js"><link rel="prefetch" href="/assets/js/4.58c6febe.js"><link rel="prefetch" href="/assets/js/40.de3559e1.js"><link rel="prefetch" href="/assets/js/41.c05865a0.js"><link rel="prefetch" href="/assets/js/42.7862f68d.js"><link rel="prefetch" href="/assets/js/43.bd5a0b9b.js"><link rel="prefetch" href="/assets/js/44.a3372c92.js"><link rel="prefetch" href="/assets/js/45.3036b2fe.js"><link rel="prefetch" href="/assets/js/46.e3cb5827.js"><link rel="prefetch" href="/assets/js/47.a046868b.js"><link rel="prefetch" href="/assets/js/5.f48a3733.js"><link rel="prefetch" href="/assets/js/6.7e3c1d96.js"><link rel="prefetch" href="/assets/js/7.ff36334e.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.d9992789.js">
=======
    <link rel="preload" href="/assets/css/0.styles.31e66d80.css" as="style"><link rel="preload" href="/assets/js/app.9d9028d3.js" as="script"><link rel="preload" href="/assets/js/2.08c95936.js" as="script"><link rel="preload" href="/assets/js/1.80ba04c7.js" as="script"><link rel="preload" href="/assets/js/33.f7ffc228.js" as="script"><link rel="preload" href="/assets/js/20.05fe0eb6.js" as="script"><link rel="prefetch" href="/assets/js/10.8a933fae.js"><link rel="prefetch" href="/assets/js/11.b348d638.js"><link rel="prefetch" href="/assets/js/12.c901df62.js"><link rel="prefetch" href="/assets/js/13.816a93d7.js"><link rel="prefetch" href="/assets/js/14.0ed80cb4.js"><link rel="prefetch" href="/assets/js/15.c2889a45.js"><link rel="prefetch" href="/assets/js/16.2824987e.js"><link rel="prefetch" href="/assets/js/17.f5878b60.js"><link rel="prefetch" href="/assets/js/18.ba3117c2.js"><link rel="prefetch" href="/assets/js/19.ecb49bc6.js"><link rel="prefetch" href="/assets/js/21.b4c97262.js"><link rel="prefetch" href="/assets/js/22.f1440856.js"><link rel="prefetch" href="/assets/js/23.9acdaad1.js"><link rel="prefetch" href="/assets/js/24.915c148b.js"><link rel="prefetch" href="/assets/js/25.773403f6.js"><link rel="prefetch" href="/assets/js/26.a46a2262.js"><link rel="prefetch" href="/assets/js/27.6afa3fcc.js"><link rel="prefetch" href="/assets/js/28.897ff82b.js"><link rel="prefetch" href="/assets/js/29.352d2ec1.js"><link rel="prefetch" href="/assets/js/3.d4b70d98.js"><link rel="prefetch" href="/assets/js/30.9b531b0a.js"><link rel="prefetch" href="/assets/js/31.32ecf447.js"><link rel="prefetch" href="/assets/js/32.13fca849.js"><link rel="prefetch" href="/assets/js/34.9690fe03.js"><link rel="prefetch" href="/assets/js/35.d8294b30.js"><link rel="prefetch" href="/assets/js/36.1a6aeb07.js"><link rel="prefetch" href="/assets/js/37.3455a21f.js"><link rel="prefetch" href="/assets/js/38.30ad1d90.js"><link rel="prefetch" href="/assets/js/39.2a5c7243.js"><link rel="prefetch" href="/assets/js/4.58c6febe.js"><link rel="prefetch" href="/assets/js/40.e728d85b.js"><link rel="prefetch" href="/assets/js/41.771d925a.js"><link rel="prefetch" href="/assets/js/42.d64d69b6.js"><link rel="prefetch" href="/assets/js/43.b8978f9d.js"><link rel="prefetch" href="/assets/js/44.222f46a3.js"><link rel="prefetch" href="/assets/js/45.79bc8196.js"><link rel="prefetch" href="/assets/js/5.f48a3733.js"><link rel="prefetch" href="/assets/js/6.7e3c1d96.js"><link rel="prefetch" href="/assets/js/7.ff36334e.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.d9992789.js">
>>>>>>> master:dist/javascript/js/index.html
    <link rel="stylesheet" href="/assets/css/0.styles.31e66d80.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/assets/img/logo.png" alt="技能总结" class="logo"> <span class="site-name can-hide">技能总结</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="javascript" class="dropdown-title"><span class="title">javascript</span> <span class="arrow down"></span></button> <button type="button" aria-label="javascript" class="mobile-dropdown-title"><span class="title">javascript</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/javascript/js/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  js
</a></li><li class="dropdown-item"><!----> <a href="/javascript/vue/" class="nav-link">
  vue
</a></li><li class="dropdown-item"><!----> <a href="/javascript/react/" class="nav-link">
  react
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其它" class="dropdown-title"><span class="title">其它</span> <span class="arrow down"></span></button> <button type="button" aria-label="其它" class="mobile-dropdown-title"><span class="title">其它</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/other/mysql/" class="nav-link">
  mysql
</a></li><li class="dropdown-item"><!----> <a href="/other/git/" class="nav-link">
  git
</a></li><li class="dropdown-item"><!----> <a href="/other/linux/nginx.html" class="nav-link">
  linux
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="javascript" class="dropdown-title"><span class="title">javascript</span> <span class="arrow down"></span></button> <button type="button" aria-label="javascript" class="mobile-dropdown-title"><span class="title">javascript</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/javascript/js/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  js
</a></li><li class="dropdown-item"><!----> <a href="/javascript/vue/" class="nav-link">
  vue
</a></li><li class="dropdown-item"><!----> <a href="/javascript/react/" class="nav-link">
  react
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其它" class="dropdown-title"><span class="title">其它</span> <span class="arrow down"></span></button> <button type="button" aria-label="其它" class="mobile-dropdown-title"><span class="title">其它</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/other/mysql/" class="nav-link">
  mysql
</a></li><li class="dropdown-item"><!----> <a href="/other/git/" class="nav-link">
  git
</a></li><li class="dropdown-item"><!----> <a href="/other/linux/nginx.html" class="nav-link">
  linux
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/javascript/js/Html.html" class="sidebar-link">html</a></li><li><a href="/javascript/js/Css3.html" class="sidebar-link">css</a></li><li><a href="/javascript/js/" aria-current="page" class="active sidebar-link">js</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/javascript/js/#_1、闭包的理解" class="sidebar-link">1、闭包的理解</a></li><li class="sidebar-sub-header"><a href="/javascript/js/#_2、如何处理-javascript-中的错误" class="sidebar-link">2、如何处理 JavaScript 中的错误</a></li><li class="sidebar-sub-header"><a href="/javascript/js/#_3、-和-的区别" class="sidebar-link">3、== 和 === 的区别</a></li><li class="sidebar-sub-header"><a href="/javascript/js/#_4、事件循环机制、同步异步、宏任务和微任务" class="sidebar-link">4、事件循环机制、同步异步、宏任务和微任务</a></li><li class="sidebar-sub-header"><a href="/javascript/js/#_5、bind、call、apply的区别和作用" class="sidebar-link">5、bind、call、apply的区别和作用</a></li><li class="sidebar-sub-header"><a href="/javascript/js/#_6、事件冒泡和事件捕获" class="sidebar-link">6、事件冒泡和事件捕获</a></li><li class="sidebar-sub-header"><a href="/javascript/js/#_7、websocket应用" class="sidebar-link">7、websocket应用</a></li></ul></li><li><a href="/javascript/js/Es6.html" class="sidebar-link">Es6</a></li><li><a href="/javascript/js/Plugins.html" class="sidebar-link">Plugins</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="_1、闭包的理解"><a href="#_1、闭包的理解" class="header-anchor">#</a> 1、闭包的理解</h2> <p>闭包是一个函数，return返回一个新函数，新函数应用了父函数的变量，返回的新函数会携带父函数的变量。<br> <strong>注：</strong> 因为新函数应用了父函数的变量，使该变量不会被系统回收。闭包使用过多，会导致内存一直增大，造成内存泄漏，尽量避免闭包的使用。</p> <div class="language- extra-class"><pre class="language-text"><code>function globalFun () {
    let a = 0;
    return function localFun () {
        console.log(a);
    };

};
const resolve = globalFun();
resolve(); // 控制台打印 0
</code></pre></div><h2 id="_2、如何处理-javascript-中的错误"><a href="#_2、如何处理-javascript-中的错误" class="header-anchor">#</a> 2、如何处理 JavaScript 中的错误</h2> <p>可以使用 try-catch 语句处理 JavaScript 中的错误。可能抛出错误的代码放在try块中，错误处理代码放在catch块中。处理后的js报错，不会导致视图层显示出错误。</p> <h2 id="_3、-和-的区别"><a href="#_3、-和-的区别" class="header-anchor">#</a> 3、== 和 === 的区别</h2> <p><strong>“==”</strong> 比较值是否相等，会做隐式类型转换。<br> <strong>“===”</strong> 不仅会比较值是否相等，还会做类型比较，如果类型不相等，返回false.</p> <h2 id="_4、事件循环机制、同步异步、宏任务和微任务"><a href="#_4、事件循环机制、同步异步、宏任务和微任务" class="header-anchor">#</a> 4、事件循环机制、同步异步、宏任务和微任务</h2> <p>JavaScript 是一种单线程的编程语言，只有一个调用栈，在同一个时间只能处理一件事，这就造成了后面的任务要等到前面的任务执行完才能执行后面的任务。<br> <strong>同步任务：</strong> 在主线程上排队执行的任务。<br> <strong>异步任务：</strong> 不进入主线程，而是进入任务队列中，排队执行的任务。</p> <img src="/assets/js_imgs/js循环机制.jpg" alt="foo" class="zoom"> <p><strong>异步任务分为宏任务和微任务：</strong> ES6 规范中，宏任务（Macrotask） 称为 Task， 微任务（Microtask） 称为 Jobs。宏任务是由宿主（浏览器、Node）发起的，而微任务由 JS 自身发起的。<strong>事件循环</strong> 过程中，执行栈在同步代码执行完成后，优先检查微任务队列是否有微任务需要执行，如果有就执行微任务，如果没有，接着执行后面的任务。<strong>总结：</strong> 开始执行宏任务，遇到微任务，就把微任务放进队列中，接着执行后面的宏任务。等第一层宏任务执行完成后，再去执行微任务。在微任务中，如果再次有其它微任务，将该微任务存放在新的队列任务中，等该微任务执行完成后，再执行第二次放进队列任务的微任务，依次嵌套执行。</p> <p><strong>宏任务：</strong>  setTimeout、setInterval、Ajax、DOM事件、script整体代码块、I/OUI交互事件、postMessageMessage、Channel setImmediate(Node.js 环境)；<br> <strong>微任务：</strong> Promise.[ then/catch/finally ]、async/await、Object.observe、MutationObserver（浏览器环境）、process.nextTick（Node环境）注意new Promise是同步执行的，和它的then()等方法区分。</p> <div class="language- extra-class"><pre class="language-text"><code>console.log('同步代码1');       1，执行第一个同步任务
 
setTimeout(() =&gt; {
    console.log('setTimeout')   5，执行宏任务
}, 0)
 
new Promise((resolve) =&gt; {
    console.log('同步代码2')      2，执行第二个同步任务
    resolve()
}).then(() =&gt; {
    console.log('promise.then') 4，执行微任务
})
 
console.log('同步代码3');       3，执行第三个同步任务
// 最终输出&quot;同步代码1&quot;、&quot;同步代码2&quot;、&quot;同步代码3&quot;、&quot;promise.then&quot;、&quot;setTimeout&quot;
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>setTimeout(() =&gt; {
    console.log('setTimeout start');    5，执行宏任务里的第一个任务
    new Promise((resolve) =&gt; { 
        console.log('promise1 start');     6，执行宏任务里的第二个任务
    resolve();
    }).then(() =&gt; {
        console.log('promise1 end');      8，执行宏任务里的微任务
    })
    console.log('setTimeout end');      7，执行宏任务里的第三个任务
}, 0);
function promise2() {
    return new Promise((resolve) =&gt; {
        console.log('promise2');         3，执行第一个微任务
        resolve();
    })
}
async function async1() {
    console.log('async1 start');       1，执行第一个同步任务
    await promise2();
    console.log('async1 end');          4，执行第二个微任务
}
async1();
console.log('script end');           2，执行第二个同步任务
</code></pre></div><h2 id="_5、bind、call、apply的区别和作用"><a href="#_5、bind、call、apply的区别和作用" class="header-anchor">#</a> 5、bind、call、apply的区别和作用</h2> <p><strong>作用：</strong> 三个方法都实现一个重要的作用：改变方法（函数）的this指向<br> <strong>区别：</strong> 最主要的区别是call()、apply()方法是立即调用当前函数，而bind()是返回一个改变了this指向的新函数，并不立即调用。</p> <ul><li>call(newThis,arg1,arg2。。。)</li> <li>apply(newThis,[arrArg])</li> <li>func().bind(this);方法的返回值是函数，绑定了调用函数的this；</li></ul> <h2 id="_6、事件冒泡和事件捕获"><a href="#_6、事件冒泡和事件捕获" class="header-anchor">#</a> 6、事件冒泡和事件捕获</h2> <p>事件冒泡是一种事件传播方式，事件从最里面的元素向外传播。事件捕获则相反，事件从最外层的元素向内传播。<br> <strong>阻止事件冒泡：</strong>  event.stopPropagation()；</p> <h2 id="_7、websocket应用"><a href="#_7、websocket应用" class="header-anchor">#</a> 7、websocket应用</h2> <blockquote><p>直接使用ws插件实现：</p></blockquote> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token special-attr"><span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript"><span class="token function">sendMsg</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>点击<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">const</span> socket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket</span><span class="token punctuation">(</span><span class="token string">&quot;ws://localhost:6060&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    socket<span class="token punctuation">.</span><span class="token function-variable function">open</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;websoket 链接打开&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    socket<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">收到回复： </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>event<span class="token punctuation">.</span>data<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    socket<span class="token punctuation">.</span><span class="token function-variable function">onclose</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;websoket 链接关闭&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment">// 交互：点击发送消息</span>
    <span class="token keyword">function</span> <span class="token function">sendMsg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        socket<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&quot;前端向后端服务发送了一条消息！&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span></code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> websoket <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'ws'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 通过http 创建一个node服务</span>
<span class="token keyword">const</span> port <span class="token operator">=</span> <span class="token number">6060</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 创建一个websocket 服务</span>
<span class="token keyword">const</span> ws <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">websoket<span class="token punctuation">.</span>Server</span><span class="token punctuation">(</span><span class="token punctuation">{</span> server <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ws<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'connection'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">socket</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;websocket 链接打开&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">message</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">收到前端发过来的消息：</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>message<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        socket<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&quot;node服务在收到前端消息后, 反馈的消息！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'close'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;websocket链接关闭!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>port<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">node服务已开启,地址:http:localhost:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>port<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><blockquote><p>使用express实现多个websocket和api短连接：</p></blockquote> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token special-attr"><span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript"><span class="token function">sendMsg</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>点击<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">const</span> socket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket</span><span class="token punctuation">(</span><span class="token string">&quot;ws://localhost:6060/ws/test1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    socket<span class="token punctuation">.</span><span class="token function-variable function">open</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;websoket 链接打开&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    socket<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">收到回复： </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>event<span class="token punctuation">.</span>data<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    socket<span class="token punctuation">.</span><span class="token function-variable function">onclose</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;websoket 链接关闭&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment">// 交互：点击发送消息</span>
    <span class="token keyword">function</span> <span class="token function">sendMsg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        socket<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&quot;前端向后端服务发送了一条消息！&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span></code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> expressWs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express-ws'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 创建服务</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 创建短连接路由</span>
<span class="token keyword">const</span> apiRouter <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 创建长连接路由</span>
<span class="token keyword">const</span> wsRouter <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">expressWs</span><span class="token punctuation">(</span>wsRouter<span class="token punctuation">)</span>
<span class="token function">expressWs</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span>

<span class="token keyword">const</span> prot <span class="token operator">=</span> <span class="token number">6060</span> <span class="token comment">// 启动端口</span>

<span class="token comment">// 短连接api</span>
apiRouter<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/test2'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">code</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">'success'</span><span class="token punctuation">,</span> <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token string">&quot;传输的数据&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">query</span><span class="token operator">:</span> req<span class="token punctuation">.</span>query <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 长连接api</span>
wsRouter<span class="token punctuation">.</span><span class="token function">ws</span><span class="token punctuation">(</span><span class="token string">'/test1'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">ws<span class="token punctuation">,</span> req</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;websocket 链接打开&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    ws<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">message</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">收到前端发过来的消息：</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>message<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        ws<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&quot;node服务在收到前端消息后, 反馈的消息！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    ws<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'close'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;websocket链接关闭!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>



<span class="token comment">// 短连接</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/api'</span><span class="token punctuation">,</span> apiRouter<span class="token punctuation">)</span>

<span class="token comment">// 长连接</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/ws'</span><span class="token punctuation">,</span> wsRouter<span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>prot<span class="token punctuation">,</span> <span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>err<span class="token punctuation">)</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">服务启动成功 http://localhost:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>prot<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<<<<<<< HEAD:docs/.vuepress/dist/javascript/js/index.html
</code></pre></div><p><a href="https://mp.weixin.qq.com/s?__biz=MjM5MDA2MTI1MA==&amp;mid=2649136663&amp;idx=3&amp;sn=4f7c0e5770c1a6114019871bc08b05f1&amp;chksm=be58b9ba892f30acd454bca86b603d42b41c2d81946eec13c74c88bd9e902bff9686134a33aa&amp;scene=27" target="_blank" rel="noopener noreferrer">来源于<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">更新时间:</span> <span class="time">2024年3月6日星期三中午11点46分</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/javascript/js/Css3.html" class="prev">
        css
      </a></span> <span class="next"><a href="/javascript/js/Es6.html">
=======
</code></pre></div><p><a href="https://mp.weixin.qq.com/s?__biz=MjM5MDA2MTI1MA==&amp;mid=2649136663&amp;idx=3&amp;sn=4f7c0e5770c1a6114019871bc08b05f1&amp;chksm=be58b9ba892f30acd454bca86b603d42b41c2d81946eec13c74c88bd9e902bff9686134a33aa&amp;scene=27" target="_blank" rel="noopener noreferrer">来源于<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">更新时间:</span> <span class="time">2024年3月6日星期三中午11点46分</span></div></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/javascript/js/Es6.html">
>>>>>>> master:dist/javascript/js/index.html
        Es6
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
<<<<<<< HEAD:docs/.vuepress/dist/javascript/js/index.html
    <script src="/assets/js/app.c4b7f1ba.js" defer></script><script src="/assets/js/2.08c95936.js" defer></script><script src="/assets/js/1.80ba04c7.js" defer></script><script src="/assets/js/35.dd6a1dfd.js" defer></script><script src="/assets/js/20.05fe0eb6.js" defer></script>
=======
    <script src="/assets/js/app.9d9028d3.js" defer></script><script src="/assets/js/2.08c95936.js" defer></script><script src="/assets/js/1.80ba04c7.js" defer></script><script src="/assets/js/33.f7ffc228.js" defer></script><script src="/assets/js/20.05fe0eb6.js" defer></script>
>>>>>>> master:dist/javascript/js/index.html
  </body>
</html>
